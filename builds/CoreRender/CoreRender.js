(()=>{"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function r(t){var r=function(t,r){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,"string");if("object"!=e(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(r)?r:String(r)}function n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,r(i.key),i)}}function i(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var a=function(){function e(r){var n=this;t(this,e),this.canvas=document.getElementById(r),this.context=this.canvas.getContext("2d"),this.drawKit={rect:function(t){n.context.fillStyle=t.color,n.context.beginPath(),n.context.fillRect(t.x,t.y,t.width,t.height),n.context.fill()},circle:function(t){n.context.fillStyle=t.color,n.context.beginPath(),n.context.arc(t.x,t.y,t.radius,0,2*Math.PI),n.context.fill()},image:function(t){t.hasOwnProperty("width")&&t.hasOwnProperty("height")?n.context.drawImage(t.image,t.x,t.y,t.width,t.height):n.context.drawImage(t.image,t.x,t.y)}}}return i(e,[{key:"renderLayer",value:function(t){for(var e=0;e<t.length;e++){var r=t[e];this.drawKit[r.type](r)}}},{key:"clearArea",value:function(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)}}]),e}();class o{constructor(t){this.value=t,this.listeners=[]}subscribe(t){return this.listeners.push(t),{unsubscribe:()=>{this.listeners=this.listeners.filter((e=>e!==t))}}}next(t){this.value=t,this.listeners.forEach((e=>{e(t)}))}getValue(){return this.value}setValue(t){this.value=t}unsubscribeAll(){this.listeners=[]}}var s=function(){function e(r){var n=this;t(this,e),this.targetFps=60,this.frame$=new o,this.coreRender=new a(r.canvasId),this.layersData=r.layersData$.getValue(),r.layersData$.subscribe((function(t){return n.layersData=t})),this.render()}return i(e,[{key:"render",value:function(){var t=this,e=0,r=1e3/this.targetFps;requestAnimationFrame((function n(i){var a=i-e;if(a>r){t.coreRender.clearArea();for(var o=0;o<t.layersData.length;o++){var s=t.layersData[o];t.coreRender.renderLayer(s)}e=i-a%r,t.frame$.next()}requestAnimationFrame(n)}))}}]),e}();window.CoreRender=a,window.LayerController=s})();